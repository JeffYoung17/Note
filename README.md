# Note

[TOC]

## 计算机组成原理

### 第一篇：概论

```shell
1.计算机系统的组成：
由硬件和软件两部分组成（计算机组成原理讲的是硬件）；

2.计算机组成和计算机体系结构：
一台机器是否具备乘法指令，这是一个结构问题；
实现乘法指令采用什么方式，这是一个组成问题；

3.现代计算机的硬件组成：
CPU，IO设备，主存储器；
CPU和主存称为主机，IO设备称为外部设备；

4.计算机硬件的技术指标：
机器字长：CPU一次能处理的数据的位数，与CPU的寄存器位数有关；
存储容量：分为主存和辅存，=存储单元个数*存储字长（单位：位），然后除以8，用字节（byte）表示容量。
运算速度：发展出来多种标准。由MIPS，百万条指令每秒；或者FLOPS，浮点运算次数每秒。
```

### 第二篇：硬件结构

Ch3-系统总线   
```shell
1.总线的分类：按照连接部件的不同进行分类
片内总线（CPU内部）
系统总线（CPU、主存和IO设备之间的信息传输线）
通信总线（和其他计算机系统或者其它系统之间的通信线）

2.总线的控制：总线上连接着多个部件，包括判优逻辑（仲裁逻辑）和通信控制
（1）判优控制：分为集中式和分布式，集中式指的是控制逻辑统一由一个地方（例如CPU）负责。
集中式判优控制分为：链式查询，计数器定时查询，独立请求
（2）通信控制：通信双方如何知道传输开始、传输结束、如何协调配合。
通信可分为几个阶段：申请分配阶段，寻址阶段，传数阶段，结束阶段。
通常有：同步、异步、半同步和分离式通信四种。
```

Ch4 - 存储器  

```shell
1.分类
按存储介质：半导体，磁表面、光盘

按存取方式：
（1）RAM，计算机的主存采用的类型，任何一个存储单元可以随机存取，和存取时间、存储单元的位置无关。又分为静态RAM（SRAM）和动态RAM（DRAM）
（2）ROM，通常用于存放固定不变的程序；后续派生出EEPROM，Flash Memory（闪存）
（3）串行访问存储器：例如光盘，对存储单元进行读写时，必须按照物理位置的先后顺序。
总结：类比数组和链表的元素访问方式，是寻秩访问还是顺序访问；

按在计算机中的作用：主存，闪存，辅存，缓存（Cache）

2.计算机存储器的层次结构：CPU的寄存器--缓存--主存--辅存
缓存--主存，解决CPU和主存速度不匹配的问题；
主存--辅存，解决存储系统的容量问题；

3.高速缓冲存储器（Cache）
程序访问的局部性原理：通过对典型程序的分析，发现CPU在一定时间内，从主存存取指令或数据的时候，只是对主存的局部地址区域进行访问，即指令和数据的地址是以相对簇聚的方式存在于主存，所以提前将CPU可能用到的内容送入Cache，可以使得CPU在一定时间内只访问Cache。
```

Ch5 - I/O系统  

```shell
1.I/O设备和主机信息传送的方式：程序查询方式，程序中断方式，DMA方式；

2.I/O设备也称为外围设备，外设；

3.I/O接口：通常指主机和I/O设备之间设置的硬件电路，及其对应的软件控制；
按照数据传送的方式可以分为并行接口和串行接口。
```

### 第三篇 中央处理器
Ch6 - 计算机的运算方法

Ch7 - 指令系统：指令的格式、寻址方式、指令系统的分类

```shell
1.指令的一般格式：
操作码和地址码；
（1）操作码的长度可固定，可变化：位数反映了机器的操作种类，例如操作码长度位7位，那么操作种类最多是128种，固定长度的操作码便于硬件设计，译码时间短；
（2）地址码：包括操作数的地址、结果的地址以及下一条指令的地址；可以是主存的、寄存器的甚至IO设备的地址；

2.操作数的类型：地址，数字，字符，逻辑运算；

3.操作类型：数据传送、算数和逻辑运算、移位等；

4.寻址方式：确定本条指令的地址以及下一条执行指令的地址的方法；
分为指令寻址和数据寻址两类；
（1）指令寻址：分为顺序寻址（程序计数器+1的方式）和跳跃寻址；
（2）数据寻址：指令种的地址码 通常不代表 操作数的真实地址，而是形式地址，操作数的真实地址称为有效地址，需要通过寻址方式和形式地址共同确定。

5.RISC（reduced instruction set computer）精简指令系统计算机
理念：用20%常用的指令，组合成80%不常用的指令。
优点：相比于复杂指令系统：
（1）RISC的指令系统的控制器，即硬件部分会更简单；
（2）计算机运行速度提高，译码更快；
（3）便于设计开发等等；
```

Ch8 - CPU的结构和功能
```shell
1.CPU的基本功能：取指令，分析指令，执行指令。

2.CPU的基本组成：算术逻辑单元ALU，控制单元CU，寄存器，中断系统。

3.指令周期：即CPU完成一条指令的时间，包括：
（1）取指周期：取指令并分析；
（2）间指周期：针对地址码不是操作数的有校地址的情况，即形式地址，需要先根据形式地址取出有效地址，再根据有效地址取出操作数。
（3）执行周期
（4）中断周期：在指令执行完后，检查一下是否有中断（主机与IO设备交换信息时），若有，则进行处理。

4.为了提高CPU的速度，有两个方面的考量：
（1）提高器件性能：这不废话么。。集成度更高，体积更小，功耗更低等。。
（2）改进系统结构，开发系统的并行性：
并行性包含同时性和并发性两个方面：
（2.1）同时性指多个事件同一时刻发生；
（2.2）并发性指同一时间段内完成多种功能；
并行性的不同等级：程序级，进程级，指令之间的级别，指令内部的级别。
前两者属于粗粒度，一般通过软件实现，后两者属于细粒度，一般用硬件实现。
```

## 计算机操作系统

### L1 什么是操作系统

计算机分为硬件和软件，硬件（裸机）和应用软件之间一层软件，就是操作系统软件，使我们方便、高效地使用硬件。需要管理的硬件有：CPU，内存，磁盘/文件，网络，电源等等。  

总结：操作系统软件 给 上层应用 提供接口 去使用硬件。  

### L2 揭开钢琴的盖子

计算机工作的本质：（CPU）取指，执行。  

上电开机：执行内存中一段固化的代码，即BIOS。  

```
（1）开机自检
（2）将引导扇区的代码(bootsec.s)加载到内存0x7c00处，开始执行。
（3）载入setup模块到内存（即setup.s）
（4）载入system模块到内存（即系统代码）
（5）将CS：IP赋值相应的值，跳转到setup.s执行 // BIOS就完事
```

### L3 操作系统启动

开始执行载入的setup.s代码，完成操作系统启动前的设置。  

```
（1）取光标位置和其他硬件参数
（2）从实模式进入保护模式等等。。。
（3）跳转到system模块执行
```

system模块的第一段代码：head.s  

```
一顿操作，从汇编转成c语言执行，执行init/main.c
```

init/main.c代码：

```
内存，中断，设备，时钟和CPU等的初始化
```

### L4 操作系统接口

操作系统接口：由普通的C代码和操作系统提供的重要函数组成，连接操作系统和应用程序。  

又称之为**系统调用（system call）**。  

程序（应用软件）通过系统调用“进入内核”。  

